(function(a){var b={init:function(b){return this.each(function(){var c=a(this),d=c.data("monthpicker"),e=b&&b.year?b.year:(new Date).getFullYear(),f=a.extend({pattern:"mm/yyyy",selectedMonth:null,selectedMonthName:"",selectedYear:e,startYear:e-10,finalYear:e+10,monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],id:"monthpicker_"+(Math.random()*Math.random()).toString().replace(".",""),openOnFocus:!0,disabledMonths:[]},b);f.dateSeparator=f.pattern.replace(/(mmm|mm|m|yyyy|yy|y)/ig,""),d||(a(this).data("monthpicker",{target:c,settings:f}),f.openOnFocus===!0&&c.on("focus",function(){c.monthpicker("show")}),c.monthpicker("parseInputValue",f),c.monthpicker("mountWidget",f),c.on("monthpicker-click-month",function(a,b,d){c.monthpicker("setValue",f),c.monthpicker("hide")}),c.addClass("mtz-monthpicker-widgetcontainer"),a(document).unbind("mousedown.mtzmonthpicker").on("mousedown.mtzmonthpicker",function(b){(!b.target.className||b.target.className.toString().indexOf("mtz-monthpicker")<0)&&a(this).monthpicker("hideAll")}))})},show:function(){a(this).monthpicker("hideAll");var b=a("#"+this.data("monthpicker").settings.id);b.css("top",this.offset().top+this.outerHeight()),a(window).width()>b.width()+this.offset().left?b.css("left",this.offset().left):b.css("left",this.offset().left-b.width()),b.show(),b.find("select").focus(),this.trigger("monthpicker-show")},hide:function(){var b=a("#"+this.data("monthpicker").settings.id);b.is(":visible")&&(b.hide(),this.trigger("monthpicker-hide"))},hideAll:function(){a(".mtz-monthpicker-widgetcontainer").each(function(){typeof a(this).data("monthpicker")!="undefined"&&a(this).monthpicker("hide")})},setValue:function(a){var b=a.selectedMonth,c=a.selectedYear;a.pattern.indexOf("mmm")>=0?b=a.selectedMonthName:a.pattern.indexOf("mm")>=0&&a.selectedMonth<10&&(b="0"+a.selectedMonth),a.pattern.indexOf("yyyy")<0&&(c=c.toString().substr(2,2)),a.pattern.indexOf("y")>a.pattern.indexOf(a.dateSeparator)?this.val(b+a.dateSeparator+c):this.val(c+a.dateSeparator+b),this.change()},disableMonths:function(b){var c=this.data("monthpicker").settings,d=a("#"+c.id);c.disabledMonths=b,d.find(".mtz-monthpicker-month").each(function(){var c=parseInt(a(this).data("month"));a.inArray(c,b)>=0?a(this).addClass("ui-state-disabled"):a(this).removeClass("ui-state-disabled")})},mountWidget:function(b){var c=this,d=a('<div id="'+b.id+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" />'),e=a('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix ui-corner-all mtz-monthpicker" />'),f=a('<select class="mtz-monthpicker mtz-monthpicker-year" />'),g=a('<table class="mtz-monthpicker" />'),h=a('<tbody class="mtz-monthpicker" />'),i=a('<tr class="mtz-monthpicker" />'),j="",k=b.selectedYear,l=null,m=a(this).data("selected-year"),n=a(this).data("start-year"),o=a(this).data("final-year");m&&(b.selectedYear=m),n&&(b.startYear=n),o&&(b.finalYear=o),d.css({position:"absolute",zIndex:999999,whiteSpace:"nowrap",width:"250px",overflow:"hidden",textAlign:"center",display:"none",top:c.offset().top+c.outerHeight(),left:c.offset().left}),f.on("change",function(){var d=a(this).parent().parent().find("td[data-month]");d.removeClass("ui-state-active"),a(this).val()==b.selectedYear&&d.filter("td[data-month="+b.selectedMonth+"]").addClass("ui-state-active"),c.trigger("monthpicker-change-year",a(this).val())});for(var p=b.startYear;p<=b.finalYear;p++){var l=a('<option class="mtz-monthpicker" />').attr("value",p).append(p);b.selectedYear==p&&l.attr("selected","selected"),f.append(l)}e.append(f).appendTo(d);for(var p=1;p<=12;p++)j=a('<td class="ui-state-default mtz-monthpicker mtz-monthpicker-month" style="padding:5px;cursor:pointer;" />').attr("data-month",p),b.selectedMonth==p&&j.addClass("ui-state-active"),j.append(b.monthNames[p-1]),i.append(j).appendTo(h),p%3===0&&(i=a('<tr class="mtz-monthpicker" />'));h.find(".mtz-monthpicker-month").on("click",function(){var d=parseInt(a(this).data("month"));a.inArray(d,b.disabledMonths)<0&&(b.selectedYear=a(this).closest(".ui-datepicker").find(".mtz-monthpicker-year").first().val(),b.selectedMonth=a(this).data("month"),b.selectedMonthName=a(this).text(),c.trigger("monthpicker-click-month",a(this).data("month")),a(this).closest("table").find(".ui-state-active").removeClass("ui-state-active"),a(this).addClass("ui-state-active"))}),g.append(h).appendTo(d),d.appendTo("body")},destroy:function(){return this.each(function(){a(this).removeClass("mtz-monthpicker-widgetcontainer").unbind("focus").removeData("monthpicker")})},getDate:function(){var a=this.data("monthpicker").settings;return a.selectedMonth&&a.selectedYear?new Date(a.selectedYear,a.selectedMonth-1):null},parseInputValue:function(a){if(this.val()&&a.dateSeparator){var b=this.val().toString().split(a.dateSeparator);a.pattern.indexOf("m")===0?(a.selectedMonth=b[0],a.selectedYear=b[1]):(a.selectedMonth=b[1],a.selectedYear=b[0])}}};a.fn.monthpicker=function(c){if(b[c])return b[c].apply(this,Array.prototype.slice.call(arguments,1));if(typeof c=="object"||!c)return b.init.apply(this,arguments);a.error("Method "+c+" does not exist on jQuery.mtz.monthpicker")}})(jQuery)