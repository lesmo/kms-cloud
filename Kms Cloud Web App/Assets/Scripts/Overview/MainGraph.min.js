$(function(){var a=$("html").attr("lang"),b=$.datepicker.regional[""];Object.has($.datepicker.regional,a)&&(b=$.datepicker.regional[a]),Date.setLocale(a),Highcharts.setOptions({global:{useUTC:!1},lang:{months:b.monthNames,shortMonths:b.monthNamesShort,weekdays:b.dayNames,resetZoom:"Restablecer Zoom",resetZoomTitle:"Restablecer Zoom a 1:1",rangeSelectorZoom:"Zoom",rangeSelectorFrom:"Desde",rangeSelectorTo:"Hasta",loading:"Cargando datos ..."}}),$.datepicker.setDefaults({dateFormat:"MM d, yy"}),$("#graficaPrincipalTabs").tabs({heightStyle:"auto",activate:function(a,b){b.newPanel.children(".graph").highcharts().reflow()}});var c=null,d=null;$("#graficaPorHora .graph-button input").datepicker({minDate:new Date(parseInt($("body").data("user-signup"))),maxDate:new Date,onSelect:function(){if(c!=null&&c==$(this).datepicker("getDate"))return;c=$(this).datepicker("getDate"),d!=null&&d.abort(),$("#graficaPorHora .graph-button button").button("option","label",$(this).val()),$("#graficaPorHora .graph").highcharts().showLoading(),d=$.getJSON(getKMS_ajaxUri("OverviewDailyData.json"),{date:$(this).datepicker("getDate").getTime(),_:$("body").data("ajax-cache")}).fail(function(){$("#graficaPorHora .graph").highcharts().showLoading("Ocurrió un problema durante la descarga, intenta de nuevo")}).done(function(a){$("#graficaPorHora .graph").highcharts().series[0].setData(a.allData),$("#graficaPorHora .graph").highcharts().hideLoading()})}}).datepicker("setDate",new Date),$("#graficaPorHora .graph-button button").button({icons:{primary:"ui-icon-calendar",secondary:"ui-icon-triangle-1-s"},label:$("#graficaPorHora .graph-button input").val()}).click(function(){$("#graficaPorHora .graph-button input").datepicker("show")});var e=null,f=null,g=null;$("#graficaPorDia .graph-button input").monthpicker({selectedYear:(new Date).getFullYear(),pattern:"mmm yyyy",startYear:(new Date(parseInt($("body").data("user-signup")))).getFullYear(),finalYear:(new Date).getFullYear(),monthNames:b.monthNames}).bind("monthpicker-change-year",function(a,b){var c=[];e=b;if(b===(new Date).getFullYear().toString()){for(var d=(new Date).getMonth()+2;d<12;d++)c.push(d);(new Date).getMonth()+1<12&&c.push(12)}else if(parseInt(b)>(new Date).getFullYear())for(var d=1;d<=12;d++)c.push(d);if(b===(new Date(parseInt($("body").data("user-signup")))).getFullYear().toString())for(var d=1;d<(new Date(parseInt($("body").data("user-signup")))).getMonth();d++)c.push(d);$(this).monthpicker("disableMonths",c)}).bind("monthpicker-click-month",function(){if(f!=null&&f==$(this).monthpicker("getDate"))return;f=$(this).monthpicker("getDate"),console.log(f),g!=null&&g.abort(),$("#graficaPorDia .graph-button button").button("option","label",$(this).val()),$("#graficaPorDia .graph").highcharts().showLoading(),g=$.getJSON(getKMS_ajaxUri("OverviewMonthlyData.json"),{date:f.getTime(),_:$("body").data("ajax-cache")}).fail(function(){$("#graficaPorDia .graph").highcharts().showLoading("Ocurrió un problema durante la descarga, intenta de nuevo")}).done(function(a){$("#graficaPorDia .graph").highcharts().series[0].setData(a.allData),$("#graficaPorDia .graph").highcharts().hideLoading()})}).val(Date.create().format("{Month} {yyyy}")).trigger("monthpicker-change-year",Date.create().format("{yyyy}")),$("#graficaPorDia .graph-button button").button({icons:{primary:"ui-icon-calendar",secondary:"ui-icon-triangle-1-s"},label:$("#graficaPorDia .graph-button input").val()}).click(function(){$("#graficaPorDia .graph-button input").monthpicker("show")}),$("#graficaPorHora .graph, #graficaPorDia .graph").each(function(){$(this).highcharts("StockChart",{title:{text:null},chart:{type:"areaspline",panning:!0,zoomType:"x"},credits:{enabled:!1},legend:{enabled:!1},navigator:{enabled:!1},rangeSelector:{enabled:!1},tooltip:{valueDecimals:2,valueSuffix:" "+$("body").data("distance-unit")},xAxis:{minRange:108e5},yAxis:{aligh:"left",labels:{format:"{value} "+$("body").data("distance-unit")},min:0},series:[{data:[],dataGrouping:{groupPixelWidth:7,approximation:"sum",units:[["hour",[1]],["day",[1]],["month",[1]]]},color:"#00C6DD",lineWidth:3,marker:{enabled:!1,radius:5,lineWidth:2,lineColor:"#FFFFFF"},name:"Distancia",pointPadding:0,groupPadding:0}]}),$(this).highcharts().showLoading()}),$("#graficaPorHora .graph").highcharts().xAxis[0].update({labels:{formatter:function(){return this.isLast?"24:00":Date.create(this.value).format("{HH}:{mm}")}}},!0)})