function doKMS_friendRequests_refresh(){if(kms_friendRequests_downloadInProgress)return;kms_friendRequests_downloadInProgress=!0,$.getJSON(getKMS_ajaxUri("FriendRequests.json")).fail(function(){console.log("[!] - Error de descarga de datos")}).done(function(a){$.each(a,function(b){var c=$("#solicitudes .solicitudItem:not(.template)").filter(function(){return $(this).data("uid")==a[b].userId});if(c.length<1){var d=$("#solicitudes .solicitudItem.template").clone(!0).data({uid:a.userId,"total-distance":a.totalDistance,"total-co2":a.totalCo2,"total-kcal":a.totalKcal,"total-cash":a.totalCash});d.children("img").attr("src",a.pictureUri),d.children("h4").text(a.name+" "+a.lastName),d.children(".kms").text(a.totalDistance+" "+$("body").data("distance-unit").toUpperCase()),$("#solicitudes").append(d),d.slideDown()}})}).always(function(){kms_friendRequests_downloadInProgress=!1})}function doKMS_friendRequests_accept(){var a=$(this).parent().parent();if(a.data("aip"))return;a.data("aip")=!0,$.post(getKMS_ajaxUri("FriendRequestAccept.json"),{friendId:a.data("uid")}).fail(function(){console.log("[!] - Error de descarga de datos")}).done(function(){a.animate({width:"hide",opacity:"hide"},{complete:function(){var b=$("#amigos .amigosItem.template").clone(!0).data($(this).data());a.children("img").attr("src",$(this).children("img").attr("src")),a.children("h4").text($(this).children("h4")),a.children(".kms").text($(this).children(".kms")),$("#amigos").prepend(a),a.slideDown(),$(this).remove(),doKMS_friendRequests_refresh()}})}).always(function(){a.data("aip")=!1})}function doKMS_friendRequest_reject(){var a=$(this).parent().parent();if(a.data("aip"))return;a.data("aip")=!0,$.post(getKMS_ajaxUri("FriendRequestReject.json"),{friendId:a.data("uid")}).fail(function(){console.log("[!] - Error de descarga de datos")}).done(function(){a.animate({width:"hide",opacity:"hide"},{complete:function(){$(this).remove()}}),doKMS_friendRequests_refresh()})}var kms_friendRequests_downloadInProgress=!1